{# components/user_profile.html #}
{% macro user_profile(user)%}

<div>
  <div class="rounded-lg shadow-md p-8 mb-8 bg-white mt-6">
    <div class="flex flex-row items-start gap-8">
      <!-- Profile Image -->
      <div>
        <div class="w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center text-gray-400 overflow-hidden">
          <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24">
            <path fill="currentColor"
              d="M5.85 17.1q1.275-.975 2.85-1.537T12 15t3.3.563t2.85 1.537q.875-1.025 1.363-2.325T20 12q0-3.325-2.337-5.663T12 4T6.337 6.338T4 12q0 1.475.488 2.775T5.85 17.1M12 13q-1.475 0-2.488-1.012T8.5 9.5t1.013-2.488T12 6t2.488 1.013T15.5 9.5t-1.012 2.488T12 13m0 9q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22" />
          </svg>
        </div>
      </div>

      <!-- User Info -->
      <div class="flex-1">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center space-x-2">
            <h2 class="text-2xl font-bold text-gray-900 ">{{ user.username }}</h2>

            {% if request.path == '/dashboard' %}
            <form action="/edit_account" method="GET">
              <button type="submit" class="p-0 m-0 bg-transparent border-0">
                  <svg xmlns="http://www.w3.org/2000/svg" class="cursor-pointer w-5 h-5 text-gray-500" viewBox="0 0 24 24">
                      <path fill="currentColor" d="M5 19h1.425L16.2 9.225L14.775 7.8L5 17.575zm-2 2v-4.25L16.2 3.575q.3-.275.663-.425t.762-.15t.775.15t.65.45L20.425 5q.3.275.438.65T21 6.4q0 .4-.137.763t-.438.662L7.25 21zM19 6.4L17.6 5zm-3.525 2.125l-.7-.725L16.2 9.225z"/>
                  </svg>
              </button>
            </form>
            {% endif %}
          </div>
          
          <!-- Rating Display -->
          <div class="flex items-center gap-2">
            <div class="flex items-center">
              {% for i in range(5) %}
                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 {% if i < user.avg_rating %}text-indigo-600{% else %}text-gray-300{% endif %}" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              {% endfor %}
            </div>
            <span class="text-gray-900 font-medium">{{ "%.1f"|format(user.avg_rating) }}</span>
            <span class="text-gray-500">({{ user.rating_count }} reviews)</span>
          </div>
        </div>
        
        <p class=" text-gray-500 mb-6">Member since {{ user.created_at.strftime('%B %Y') }}</p>

        <div>
          <h3 class="font-semibold text-gray-900 mb-2">About</h3>
          <p class="text-gray-700 leading-relaxed">
            {{ user.about or 'This user has not added an "About" section yet.' }}
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endmacro %}
